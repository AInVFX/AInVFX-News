{"id":"c6e410bc-5e2c-460b-ae81-c91b6094fbb1","revision":0,"last_node_id":120,"last_link_id":104,"nodes":[{"id":37,"type":"WanVideoEmptyEmbeds","pos":[1305.26708984375,-571.7843627929688],"size":[315,106],"flags":{},"order":0,"mode":0,"inputs":[{"localized_name":"control_embeds","name":"control_embeds","shape":7,"type":"WANVIDIMAGE_EMBEDS","link":null},{"localized_name":"width","name":"width","type":"INT","widget":{"name":"width"},"link":null},{"localized_name":"height","name":"height","type":"INT","widget":{"name":"height"},"link":null},{"localized_name":"num_frames","name":"num_frames","type":"INT","widget":{"name":"num_frames"},"link":null}],"outputs":[{"localized_name":"image_embeds","name":"image_embeds","type":"WANVIDIMAGE_EMBEDS","links":[42]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoEmptyEmbeds"},"widgets_values":[832,480,81]},{"id":36,"type":"Note","pos":[723.7317504882812,-597.3093872070312],"size":[374.3061828613281,171.9547576904297],"flags":{},"order":1,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["fp8_fast seems to cause huge quality degradation\n\nfp_16_fast enables \"Full FP16 Accmumulation in FP16 GEMMs\" feature available in the very latest pytorch nightly, this is around 20% speed boost. \n\nSageattn if you have it installed can be used for almost double inference speed"],"color":"#432","bgcolor":"#653"},{"id":42,"type":"Note","pos":[-165.44613647460938,-344.9282531738281],"size":[314.96246337890625,152.77333068847656],"flags":{},"order":2,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Adjust the blocks to swap based on your VRAM, this is a tradeoff between speed and memory usage.\n\nAlternatively there's option to use VRAM management introduced in DiffSynt-Studios. This is usually slower, but saves even more VRAM compared to BlockSwap"],"color":"#432","bgcolor":"#653"},{"id":45,"type":"WanVideoVRAMManagement","pos":[-158.19737243652344,-136.97467041015625],"size":[315,58],"flags":{},"order":3,"mode":0,"inputs":[{"localized_name":"offload_percent","name":"offload_percent","type":"FLOAT","widget":{"name":"offload_percent"},"link":null}],"outputs":[{"localized_name":"vram_management_args","name":"vram_management_args","type":"VRAM_MANAGEMENTARGS","links":[]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoVRAMManagement"},"widgets_values":[1]},{"id":33,"type":"Note","pos":[-153.7365264892578,-16.124788284301758],"size":[359.0753479003906,88],"flags":{},"order":4,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Models:\nhttps://huggingface.co/Kijai/WanVideo_comfy/tree/main"],"color":"#432","bgcolor":"#653"},{"id":54,"type":"Note","pos":[879.0575561523438,-931.8794555664062],"size":[327.61932373046875,88],"flags":{},"order":5,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Enhance-a-video can increase the fidelity of the results, too high values lead to noisy results."],"color":"#432","bgcolor":"#653"},{"id":44,"type":"Note","pos":[-98.58364868164062,-675.3411254882812],"size":[303.0501403808594,88],"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["If you have Triton installed, connect this for ~30% speed increase"],"color":"#432","bgcolor":"#653"},{"id":16,"type":"WanVideoTextEncode","pos":[675.8850708007812,-36.032100677490234],"size":[420.30511474609375,261.5306701660156],"flags":{},"order":55,"mode":0,"inputs":[{"localized_name":"t5","name":"t5","type":"WANTEXTENCODER","link":15},{"localized_name":"model_to_offload","name":"model_to_offload","shape":7,"type":"WANVIDEOMODEL","link":null},{"localized_name":"positive_prompt","name":"positive_prompt","type":"STRING","widget":{"name":"positive_prompt"},"link":null},{"localized_name":"negative_prompt","name":"negative_prompt","type":"STRING","widget":{"name":"negative_prompt"},"link":null},{"localized_name":"force_offload","name":"force_offload","shape":7,"type":"BOOLEAN","widget":{"name":"force_offload"},"link":null}],"outputs":[{"localized_name":"text_embeds","name":"text_embeds","type":"WANVIDEOTEXTEMBEDS","slot_index":0,"links":[30]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoTextEncode"},"widgets_values":["high quality nature video featuring a red panda balancing on a bamboo stem while a bird lands on it's head, on the background there is a waterfall","色调艳丽，过曝，静态，细节模糊不清，字幕，风格，作品，画作，画面，静止，整体发灰，最差质量，低质量，JPEG压缩残留，丑陋的，残缺的，多余的手指，画得不好的手部，画得不好的脸部，畸形的，毁容的，形态畸形的肢体，手指融合，静止不动的画面，杂乱的背景，三条腿，背景人很多，倒着走",true],"color":"#332922","bgcolor":"#593930"},{"id":55,"type":"WanVideoEnhanceAVideo","pos":[883.1749877929688,-789.3111572265625],"size":[315,106],"flags":{},"order":7,"mode":0,"inputs":[{"localized_name":"weight","name":"weight","type":"FLOAT","widget":{"name":"weight"},"link":null},{"localized_name":"start_percent","name":"start_percent","type":"FLOAT","widget":{"name":"start_percent"},"link":null},{"localized_name":"end_percent","name":"end_percent","type":"FLOAT","widget":{"name":"end_percent"},"link":null}],"outputs":[{"localized_name":"feta_args","name":"feta_args","type":"FETAARGS","links":[57]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoEnhanceAVideo"},"widgets_values":[2,0,1]},{"id":38,"type":"WanVideoVAELoader","pos":[1687.4093017578125,-582.2750854492188],"size":[315,82],"flags":{},"order":8,"mode":0,"inputs":[{"localized_name":"model_name","name":"model_name","type":"COMBO","widget":{"name":"model_name"},"link":null},{"localized_name":"precision","name":"precision","shape":7,"type":"COMBO","widget":{"name":"precision"},"link":null}],"outputs":[{"localized_name":"vae","name":"vae","type":"WANVAE","slot_index":0,"links":[43]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoVAELoader"},"widgets_values":["Wan2_1_VAE_bf16.safetensors","bf16"],"color":"#322","bgcolor":"#533"},{"id":11,"type":"LoadWanVideoT5TextEncoder","pos":[224.15325927734375,-34.481563568115234],"size":[377.1661376953125,130],"flags":{},"order":9,"mode":0,"inputs":[{"localized_name":"model_name","name":"model_name","type":"COMBO","widget":{"name":"model_name"},"link":null},{"localized_name":"precision","name":"precision","type":"COMBO","widget":{"name":"precision"},"link":null},{"localized_name":"load_device","name":"load_device","shape":7,"type":"COMBO","widget":{"name":"load_device"},"link":null},{"localized_name":"quantization","name":"quantization","shape":7,"type":"COMBO","widget":{"name":"quantization"},"link":null}],"outputs":[{"localized_name":"wan_t5_model","name":"wan_t5_model","type":"WANTEXTENCODER","slot_index":0,"links":[15]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"LoadWanVideoT5TextEncoder"},"widgets_values":["umt5-xxl-enc-bf16.safetensors","bf16","offload_device","disabled"],"color":"#332922","bgcolor":"#593930"},{"id":35,"type":"WanVideoTorchCompileSettings","pos":[222.5817413330078,-677.6240844726562],"size":[390.5999755859375,202],"flags":{},"order":10,"mode":0,"inputs":[{"localized_name":"backend","name":"backend","type":"COMBO","widget":{"name":"backend"},"link":null},{"localized_name":"fullgraph","name":"fullgraph","type":"BOOLEAN","widget":{"name":"fullgraph"},"link":null},{"localized_name":"mode","name":"mode","type":"COMBO","widget":{"name":"mode"},"link":null},{"localized_name":"dynamic","name":"dynamic","type":"BOOLEAN","widget":{"name":"dynamic"},"link":null},{"localized_name":"dynamo_cache_size_limit","name":"dynamo_cache_size_limit","type":"INT","widget":{"name":"dynamo_cache_size_limit"},"link":null},{"localized_name":"compile_transformer_blocks_only","name":"compile_transformer_blocks_only","type":"BOOLEAN","widget":{"name":"compile_transformer_blocks_only"},"link":null},{"localized_name":"dynamo_recompile_limit","name":"dynamo_recompile_limit","shape":7,"type":"INT","widget":{"name":"dynamo_recompile_limit"},"link":null}],"outputs":[{"localized_name":"torch_compile_args","name":"torch_compile_args","type":"WANCOMPILEARGS","slot_index":0,"links":[58]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoTorchCompileSettings"},"widgets_values":["inductor",false,"default",false,64,true,128]},{"id":39,"type":"WanVideoBlockSwap","pos":[253.16395568847656,-343.3807678222656],"size":[315,154],"flags":{},"order":11,"mode":0,"inputs":[{"localized_name":"blocks_to_swap","name":"blocks_to_swap","type":"INT","widget":{"name":"blocks_to_swap"},"link":null},{"localized_name":"offload_img_emb","name":"offload_img_emb","type":"BOOLEAN","widget":{"name":"offload_img_emb"},"link":null},{"localized_name":"offload_txt_emb","name":"offload_txt_emb","type":"BOOLEAN","widget":{"name":"offload_txt_emb"},"link":null},{"localized_name":"use_non_blocking","name":"use_non_blocking","shape":7,"type":"BOOLEAN","widget":{"name":"use_non_blocking"},"link":null},{"localized_name":"vace_blocks_to_swap","name":"vace_blocks_to_swap","shape":7,"type":"INT","widget":{"name":"vace_blocks_to_swap"},"link":null}],"outputs":[{"localized_name":"block_swap_args","name":"block_swap_args","type":"BLOCKSWAPARGS","slot_index":0,"links":[50]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoBlockSwap"},"widgets_values":[15,false,false,true,0],"color":"#223","bgcolor":"#335"},{"id":56,"type":"WanVideoLoraSelect","pos":[-107.02889251708984,-512.8568725585938],"size":[270,126],"flags":{},"order":12,"mode":0,"inputs":[{"localized_name":"prev_lora","name":"prev_lora","shape":7,"type":"WANVIDLORA","link":null},{"localized_name":"blocks","name":"blocks","shape":7,"type":"SELECTEDBLOCKS","link":null},{"localized_name":"lora","name":"lora","type":"COMBO","widget":{"name":"lora"},"link":null},{"localized_name":"strength","name":"strength","type":"FLOAT","widget":{"name":"strength"},"link":null},{"localized_name":"low_mem_load","name":"low_mem_load","shape":7,"type":"BOOLEAN","widget":{"name":"low_mem_load"},"link":null}],"outputs":[{"localized_name":"lora","name":"lora","type":"WANVIDLORA","links":[59]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoLoraSelect"},"widgets_values":["Wan21_T2V_14B_lightx2v_cfg_step_distill_lora_rank32.safetensors",1,false]},{"id":27,"type":"WanVideoSampler","pos":[1315.2401123046875,-401.48028564453125],"size":[315,578],"flags":{},"order":66,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"WANVIDEOMODEL","link":29},{"localized_name":"image_embeds","name":"image_embeds","type":"WANVIDIMAGE_EMBEDS","link":42},{"localized_name":"text_embeds","name":"text_embeds","shape":7,"type":"WANVIDEOTEXTEMBEDS","link":30},{"localized_name":"samples","name":"samples","shape":7,"type":"LATENT","link":null},{"localized_name":"feta_args","name":"feta_args","shape":7,"type":"FETAARGS","link":57},{"localized_name":"context_options","name":"context_options","shape":7,"type":"WANVIDCONTEXT","link":null},{"localized_name":"cache_args","name":"cache_args","shape":7,"type":"CACHEARGS","link":null},{"localized_name":"flowedit_args","name":"flowedit_args","shape":7,"type":"FLOWEDITARGS","link":null},{"localized_name":"slg_args","name":"slg_args","shape":7,"type":"SLGARGS","link":null},{"localized_name":"loop_args","name":"loop_args","shape":7,"type":"LOOPARGS","link":null},{"localized_name":"experimental_args","name":"experimental_args","shape":7,"type":"EXPERIMENTALARGS","link":null},{"localized_name":"sigmas","name":"sigmas","shape":7,"type":"SIGMAS","link":null},{"localized_name":"unianimate_poses","name":"unianimate_poses","shape":7,"type":"UNIANIMATE_POSE","link":null},{"localized_name":"fantasytalking_embeds","name":"fantasytalking_embeds","shape":7,"type":"FANTASYTALKING_EMBEDS","link":null},{"localized_name":"uni3c_embeds","name":"uni3c_embeds","shape":7,"type":"UNI3C_EMBEDS","link":null},{"localized_name":"steps","name":"steps","type":"INT","widget":{"name":"steps"},"link":null},{"localized_name":"cfg","name":"cfg","type":"FLOAT","widget":{"name":"cfg"},"link":null},{"localized_name":"shift","name":"shift","type":"FLOAT","widget":{"name":"shift"},"link":null},{"localized_name":"seed","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"force_offload","name":"force_offload","type":"BOOLEAN","widget":{"name":"force_offload"},"link":null},{"localized_name":"scheduler","name":"scheduler","type":"COMBO","widget":{"name":"scheduler"},"link":null},{"localized_name":"riflex_freq_index","name":"riflex_freq_index","type":"INT","widget":{"name":"riflex_freq_index"},"link":null},{"localized_name":"denoise_strength","name":"denoise_strength","shape":7,"type":"FLOAT","widget":{"name":"denoise_strength"},"link":null},{"localized_name":"batched_cfg","name":"batched_cfg","shape":7,"type":"BOOLEAN","widget":{"name":"batched_cfg"},"link":null},{"localized_name":"rope_function","name":"rope_function","shape":7,"type":"COMBO","widget":{"name":"rope_function"},"link":null}],"outputs":[{"localized_name":"samples","name":"samples","type":"LATENT","slot_index":0,"links":[33]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoSampler"},"widgets_values":[4,1.0000000000000002,5,1057359483639287,"fixed",true,"unipc",0,1,false,"comfy"]},{"id":28,"type":"WanVideoDecode","pos":[1692.973876953125,-404.8614501953125],"size":[315,174],"flags":{},"order":70,"mode":0,"inputs":[{"localized_name":"vae","name":"vae","type":"WANVAE","link":43},{"localized_name":"samples","name":"samples","type":"LATENT","link":33},{"localized_name":"enable_vae_tiling","name":"enable_vae_tiling","type":"BOOLEAN","widget":{"name":"enable_vae_tiling"},"link":null},{"localized_name":"tile_x","name":"tile_x","type":"INT","widget":{"name":"tile_x"},"link":null},{"localized_name":"tile_y","name":"tile_y","type":"INT","widget":{"name":"tile_y"},"link":null},{"localized_name":"tile_stride_x","name":"tile_stride_x","type":"INT","widget":{"name":"tile_stride_x"},"link":null},{"localized_name":"tile_stride_y","name":"tile_stride_y","type":"INT","widget":{"name":"tile_stride_y"},"link":null}],"outputs":[{"localized_name":"images","name":"images","type":"IMAGE","slot_index":0,"links":[36]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoDecode"},"widgets_values":[false,272,272,144,128],"color":"#322","bgcolor":"#533"},{"id":22,"type":"WanVideoModelLoader","pos":[620.3950805664062,-357.8426818847656],"size":[477.4410095214844,254],"flags":{},"order":56,"mode":0,"inputs":[{"localized_name":"compile_args","name":"compile_args","shape":7,"type":"WANCOMPILEARGS","link":58},{"localized_name":"block_swap_args","name":"block_swap_args","shape":7,"type":"BLOCKSWAPARGS","link":50},{"localized_name":"lora","name":"lora","shape":7,"type":"WANVIDLORA","link":59},{"localized_name":"vram_management_args","name":"vram_management_args","shape":7,"type":"VRAM_MANAGEMENTARGS","link":null},{"localized_name":"vace_model","name":"vace_model","shape":7,"type":"VACEPATH","link":null},{"localized_name":"fantasytalking_model","name":"fantasytalking_model","shape":7,"type":"FANTASYTALKINGMODEL","link":null},{"localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"localized_name":"base_precision","name":"base_precision","type":"COMBO","widget":{"name":"base_precision"},"link":null},{"localized_name":"quantization","name":"quantization","type":"COMBO","widget":{"name":"quantization"},"link":null},{"localized_name":"load_device","name":"load_device","type":"COMBO","widget":{"name":"load_device"},"link":null},{"localized_name":"attention_mode","name":"attention_mode","shape":7,"type":"COMBO","widget":{"name":"attention_mode"},"link":null}],"outputs":[{"localized_name":"model","name":"model","type":"WANVIDEOMODEL","slot_index":0,"links":[29]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoModelLoader"},"widgets_values":["Wan2_1-T2V-14B_fp8_e4m3fn.safetensors","fp16_fast","fp8_e4m3fn","offload_device","sageattn"],"color":"#223","bgcolor":"#335"},{"id":30,"type":"VHS_VideoCombine","pos":[2068.651611328125,-582.5413818359375],"size":[1245.8460693359375,1055.2188720703125],"flags":{},"order":74,"mode":4,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":36},{"localized_name":"audio","name":"audio","shape":7,"type":"AUDIO","link":null},{"localized_name":"meta_batch","name":"meta_batch","shape":7,"type":"VHS_BatchManager","link":null},{"localized_name":"vae","name":"vae","shape":7,"type":"VAE","link":null},{"localized_name":"frame_rate","name":"frame_rate","type":"FLOAT","widget":{"name":"frame_rate"},"link":null},{"localized_name":"loop_count","name":"loop_count","type":"INT","widget":{"name":"loop_count"},"link":null},{"localized_name":"filename_prefix","name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":null},{"localized_name":"format","name":"format","type":"COMBO","widget":{"name":"format"},"link":null},{"localized_name":"pingpong","name":"pingpong","type":"BOOLEAN","widget":{"name":"pingpong"},"link":null},{"localized_name":"save_output","name":"save_output","type":"BOOLEAN","widget":{"name":"save_output"},"link":null}],"outputs":[{"localized_name":"Filenames","name":"Filenames","type":"VHS_FILENAMES","links":null}],"properties":{"cnr_id":"comfyui-videohelpersuite","ver":"1.6.1","Node name for S&R":"VHS_VideoCombine"},"widgets_values":{"frame_rate":16,"loop_count":0,"filename_prefix":"selfforcing-ref","format":"video/h264-mp4","pix_fmt":"yuv420p","crf":19,"save_metadata":true,"trim_to_audio":false,"pingpong":false,"save_output":true,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"selfforcing-ref_00010.mp4","subfolder":"","type":"output","format":"video/h264-mp4","frame_rate":16,"workflow":"selfforcing-ref_00010.png","fullpath":"/data/ComfyUI2505/output/selfforcing-ref_00010.mp4"}}}},{"id":58,"type":"WanVideoEmptyEmbeds","pos":[1265.6484375,1042.9410400390625],"size":[315,106],"flags":{},"order":13,"mode":0,"inputs":[{"localized_name":"control_embeds","name":"control_embeds","shape":7,"type":"WANVIDIMAGE_EMBEDS","link":null},{"localized_name":"width","name":"width","type":"INT","widget":{"name":"width"},"link":null},{"localized_name":"height","name":"height","type":"INT","widget":{"name":"height"},"link":null},{"localized_name":"num_frames","name":"num_frames","type":"INT","widget":{"name":"num_frames"},"link":null}],"outputs":[{"localized_name":"image_embeds","name":"image_embeds","type":"WANVIDIMAGE_EMBEDS","links":[63]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoEmptyEmbeds"},"widgets_values":[832,480,81]},{"id":59,"type":"Note","pos":[684.1130981445312,1017.416015625],"size":[374.3061828613281,171.9547576904297],"flags":{},"order":14,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["fp8_fast seems to cause huge quality degradation\n\nfp_16_fast enables \"Full FP16 Accmumulation in FP16 GEMMs\" feature available in the very latest pytorch nightly, this is around 20% speed boost. \n\nSageattn if you have it installed can be used for almost double inference speed"],"color":"#432","bgcolor":"#653"},{"id":60,"type":"Note","pos":[-205.065185546875,1269.797119140625],"size":[314.96246337890625,152.77333068847656],"flags":{},"order":15,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Adjust the blocks to swap based on your VRAM, this is a tradeoff between speed and memory usage.\n\nAlternatively there's option to use VRAM management introduced in DiffSynt-Studios. This is usually slower, but saves even more VRAM compared to BlockSwap"],"color":"#432","bgcolor":"#653"},{"id":61,"type":"WanVideoVRAMManagement","pos":[-197.81640625,1477.750732421875],"size":[315,58],"flags":{},"order":16,"mode":0,"inputs":[{"localized_name":"offload_percent","name":"offload_percent","type":"FLOAT","widget":{"name":"offload_percent"},"link":null}],"outputs":[{"localized_name":"vram_management_args","name":"vram_management_args","type":"VRAM_MANAGEMENTARGS","links":[]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoVRAMManagement"},"widgets_values":[1]},{"id":62,"type":"Note","pos":[-193.35556030273438,1598.6005859375],"size":[359.0753479003906,88],"flags":{},"order":17,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Models:\nhttps://huggingface.co/Kijai/WanVideo_comfy/tree/main"],"color":"#432","bgcolor":"#653"},{"id":63,"type":"Note","pos":[839.43896484375,682.8463745117188],"size":[327.61932373046875,88],"flags":{},"order":18,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Enhance-a-video can increase the fidelity of the results, too high values lead to noisy results."],"color":"#432","bgcolor":"#653"},{"id":64,"type":"Note","pos":[-138.2027587890625,939.38427734375],"size":[303.0501403808594,88],"flags":{},"order":19,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["If you have Triton installed, connect this for ~30% speed increase"],"color":"#432","bgcolor":"#653"},{"id":66,"type":"WanVideoEnhanceAVideo","pos":[843.556396484375,825.4144287109375],"size":[315,106],"flags":{},"order":20,"mode":0,"inputs":[{"localized_name":"weight","name":"weight","type":"FLOAT","widget":{"name":"weight"},"link":null},{"localized_name":"start_percent","name":"start_percent","type":"FLOAT","widget":{"name":"start_percent"},"link":null},{"localized_name":"end_percent","name":"end_percent","type":"FLOAT","widget":{"name":"end_percent"},"link":null}],"outputs":[{"localized_name":"feta_args","name":"feta_args","type":"FETAARGS","links":[65]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoEnhanceAVideo"},"widgets_values":[2,0,1]},{"id":67,"type":"WanVideoVAELoader","pos":[1647.7904052734375,1032.4503173828125],"size":[315,82],"flags":{},"order":21,"mode":0,"inputs":[{"localized_name":"model_name","name":"model_name","type":"COMBO","widget":{"name":"model_name"},"link":null},{"localized_name":"precision","name":"precision","shape":7,"type":"COMBO","widget":{"name":"precision"},"link":null}],"outputs":[{"localized_name":"vae","name":"vae","type":"WANVAE","slot_index":0,"links":[66]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoVAELoader"},"widgets_values":["Wan2_1_VAE_bf16.safetensors","bf16"],"color":"#322","bgcolor":"#533"},{"id":69,"type":"WanVideoTorchCompileSettings","pos":[182.96275329589844,937.101318359375],"size":[390.5999755859375,202],"flags":{},"order":22,"mode":0,"inputs":[{"localized_name":"backend","name":"backend","type":"COMBO","widget":{"name":"backend"},"link":null},{"localized_name":"fullgraph","name":"fullgraph","type":"BOOLEAN","widget":{"name":"fullgraph"},"link":null},{"localized_name":"mode","name":"mode","type":"COMBO","widget":{"name":"mode"},"link":null},{"localized_name":"dynamic","name":"dynamic","type":"BOOLEAN","widget":{"name":"dynamic"},"link":null},{"localized_name":"dynamo_cache_size_limit","name":"dynamo_cache_size_limit","type":"INT","widget":{"name":"dynamo_cache_size_limit"},"link":null},{"localized_name":"compile_transformer_blocks_only","name":"compile_transformer_blocks_only","type":"BOOLEAN","widget":{"name":"compile_transformer_blocks_only"},"link":null},{"localized_name":"dynamo_recompile_limit","name":"dynamo_recompile_limit","shape":7,"type":"INT","widget":{"name":"dynamo_recompile_limit"},"link":null}],"outputs":[{"localized_name":"torch_compile_args","name":"torch_compile_args","type":"WANCOMPILEARGS","slot_index":0,"links":[68]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoTorchCompileSettings"},"widgets_values":["inductor",false,"default",false,64,true,128]},{"id":70,"type":"WanVideoBlockSwap","pos":[213.5449676513672,1271.3446044921875],"size":[315,154],"flags":{},"order":23,"mode":0,"inputs":[{"localized_name":"blocks_to_swap","name":"blocks_to_swap","type":"INT","widget":{"name":"blocks_to_swap"},"link":null},{"localized_name":"offload_img_emb","name":"offload_img_emb","type":"BOOLEAN","widget":{"name":"offload_img_emb"},"link":null},{"localized_name":"offload_txt_emb","name":"offload_txt_emb","type":"BOOLEAN","widget":{"name":"offload_txt_emb"},"link":null},{"localized_name":"use_non_blocking","name":"use_non_blocking","shape":7,"type":"BOOLEAN","widget":{"name":"use_non_blocking"},"link":null},{"localized_name":"vace_blocks_to_swap","name":"vace_blocks_to_swap","shape":7,"type":"INT","widget":{"name":"vace_blocks_to_swap"},"link":null}],"outputs":[{"localized_name":"block_swap_args","name":"block_swap_args","type":"BLOCKSWAPARGS","slot_index":0,"links":[69]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoBlockSwap"},"widgets_values":[15,false,false,true,0],"color":"#223","bgcolor":"#335"},{"id":71,"type":"WanVideoLoraSelect","pos":[-146.6479949951172,1101.8685302734375],"size":[270,126],"flags":{},"order":24,"mode":0,"inputs":[{"localized_name":"prev_lora","name":"prev_lora","shape":7,"type":"WANVIDLORA","link":null},{"localized_name":"blocks","name":"blocks","shape":7,"type":"SELECTEDBLOCKS","link":null},{"localized_name":"lora","name":"lora","type":"COMBO","widget":{"name":"lora"},"link":null},{"localized_name":"strength","name":"strength","type":"FLOAT","widget":{"name":"strength"},"link":null},{"localized_name":"low_mem_load","name":"low_mem_load","shape":7,"type":"BOOLEAN","widget":{"name":"low_mem_load"},"link":null}],"outputs":[{"localized_name":"lora","name":"lora","type":"WANVIDLORA","links":[70]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoLoraSelect"},"widgets_values":["Wan21_T2V_14B_lightx2v_cfg_step_distill_lora_rank32.safetensors",1,false]},{"id":72,"type":"WanVideoSampler","pos":[1275.6214599609375,1213.2451171875],"size":[315,578],"flags":{},"order":71,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"WANVIDEOMODEL","link":62},{"localized_name":"image_embeds","name":"image_embeds","type":"WANVIDIMAGE_EMBEDS","link":63},{"localized_name":"text_embeds","name":"text_embeds","shape":7,"type":"WANVIDEOTEXTEMBEDS","link":71},{"localized_name":"samples","name":"samples","shape":7,"type":"LATENT","link":null},{"localized_name":"feta_args","name":"feta_args","shape":7,"type":"FETAARGS","link":65},{"localized_name":"context_options","name":"context_options","shape":7,"type":"WANVIDCONTEXT","link":null},{"localized_name":"cache_args","name":"cache_args","shape":7,"type":"CACHEARGS","link":null},{"localized_name":"flowedit_args","name":"flowedit_args","shape":7,"type":"FLOWEDITARGS","link":null},{"localized_name":"slg_args","name":"slg_args","shape":7,"type":"SLGARGS","link":null},{"localized_name":"loop_args","name":"loop_args","shape":7,"type":"LOOPARGS","link":null},{"localized_name":"experimental_args","name":"experimental_args","shape":7,"type":"EXPERIMENTALARGS","link":null},{"localized_name":"sigmas","name":"sigmas","shape":7,"type":"SIGMAS","link":null},{"localized_name":"unianimate_poses","name":"unianimate_poses","shape":7,"type":"UNIANIMATE_POSE","link":null},{"localized_name":"fantasytalking_embeds","name":"fantasytalking_embeds","shape":7,"type":"FANTASYTALKING_EMBEDS","link":null},{"localized_name":"uni3c_embeds","name":"uni3c_embeds","shape":7,"type":"UNI3C_EMBEDS","link":null},{"localized_name":"steps","name":"steps","type":"INT","widget":{"name":"steps"},"link":null},{"localized_name":"cfg","name":"cfg","type":"FLOAT","widget":{"name":"cfg"},"link":null},{"localized_name":"shift","name":"shift","type":"FLOAT","widget":{"name":"shift"},"link":null},{"localized_name":"seed","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"force_offload","name":"force_offload","type":"BOOLEAN","widget":{"name":"force_offload"},"link":null},{"localized_name":"scheduler","name":"scheduler","type":"COMBO","widget":{"name":"scheduler"},"link":null},{"localized_name":"riflex_freq_index","name":"riflex_freq_index","type":"INT","widget":{"name":"riflex_freq_index"},"link":null},{"localized_name":"denoise_strength","name":"denoise_strength","shape":7,"type":"FLOAT","widget":{"name":"denoise_strength"},"link":null},{"localized_name":"batched_cfg","name":"batched_cfg","shape":7,"type":"BOOLEAN","widget":{"name":"batched_cfg"},"link":null},{"localized_name":"rope_function","name":"rope_function","shape":7,"type":"COMBO","widget":{"name":"rope_function"},"link":null}],"outputs":[{"localized_name":"samples","name":"samples","type":"LATENT","slot_index":0,"links":[67]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoSampler"},"widgets_values":[4,1.0000000000000002,5,1057359483639287,"fixed",true,"unipc",0,1,false,"comfy"]},{"id":73,"type":"WanVideoDecode","pos":[1653.3548583984375,1209.8638916015625],"size":[315,174],"flags":{},"order":75,"mode":0,"inputs":[{"localized_name":"vae","name":"vae","type":"WANVAE","link":66},{"localized_name":"samples","name":"samples","type":"LATENT","link":67},{"localized_name":"enable_vae_tiling","name":"enable_vae_tiling","type":"BOOLEAN","widget":{"name":"enable_vae_tiling"},"link":null},{"localized_name":"tile_x","name":"tile_x","type":"INT","widget":{"name":"tile_x"},"link":null},{"localized_name":"tile_y","name":"tile_y","type":"INT","widget":{"name":"tile_y"},"link":null},{"localized_name":"tile_stride_x","name":"tile_stride_x","type":"INT","widget":{"name":"tile_stride_x"},"link":null},{"localized_name":"tile_stride_y","name":"tile_stride_y","type":"INT","widget":{"name":"tile_stride_y"},"link":null}],"outputs":[{"localized_name":"images","name":"images","type":"IMAGE","slot_index":0,"links":[60]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoDecode"},"widgets_values":[false,272,272,144,128],"color":"#322","bgcolor":"#533"},{"id":74,"type":"WanVideoModelLoader","pos":[580.7763061523438,1256.8826904296875],"size":[477.4410095214844,254],"flags":{},"order":57,"mode":0,"inputs":[{"localized_name":"compile_args","name":"compile_args","shape":7,"type":"WANCOMPILEARGS","link":68},{"localized_name":"block_swap_args","name":"block_swap_args","shape":7,"type":"BLOCKSWAPARGS","link":69},{"localized_name":"lora","name":"lora","shape":7,"type":"WANVIDLORA","link":70},{"localized_name":"vram_management_args","name":"vram_management_args","shape":7,"type":"VRAM_MANAGEMENTARGS","link":null},{"localized_name":"vace_model","name":"vace_model","shape":7,"type":"VACEPATH","link":null},{"localized_name":"fantasytalking_model","name":"fantasytalking_model","shape":7,"type":"FANTASYTALKINGMODEL","link":null},{"localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"localized_name":"base_precision","name":"base_precision","type":"COMBO","widget":{"name":"base_precision"},"link":null},{"localized_name":"quantization","name":"quantization","type":"COMBO","widget":{"name":"quantization"},"link":null},{"localized_name":"load_device","name":"load_device","type":"COMBO","widget":{"name":"load_device"},"link":null},{"localized_name":"attention_mode","name":"attention_mode","shape":7,"type":"COMBO","widget":{"name":"attention_mode"},"link":null}],"outputs":[{"localized_name":"model","name":"model","type":"WANVIDEOMODEL","slot_index":0,"links":[62]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoModelLoader"},"widgets_values":["Wan2_1-T2V-14B_fp8_e4m3fn.safetensors","fp16_fast","fp8_e4m3fn","offload_device","sageattn"],"color":"#223","bgcolor":"#335"},{"id":75,"type":"WanVideoApplyNAG","pos":[1069.6790771484375,2020.5240478515625],"size":[287.77734375,126],"flags":{},"order":67,"mode":0,"inputs":[{"localized_name":"original_text_embeds","name":"original_text_embeds","type":"WANVIDEOTEXTEMBEDS","link":72},{"localized_name":"nag_text_embeds","name":"nag_text_embeds","type":"WANVIDEOTEXTEMBEDS","link":74},{"localized_name":"nag_scale","name":"nag_scale","type":"FLOAT","widget":{"name":"nag_scale"},"link":null},{"localized_name":"nag_tau","name":"nag_tau","type":"FLOAT","widget":{"name":"nag_tau"},"link":null},{"localized_name":"nag_alpha","name":"nag_alpha","type":"FLOAT","widget":{"name":"nag_alpha"},"link":null}],"outputs":[{"localized_name":"text_embeds","name":"text_embeds","type":"WANVIDEOTEXTEMBEDS","links":[71]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoApplyNAG"},"widgets_values":[11,2.5,0.25]},{"id":65,"type":"WanVideoTextEncode","pos":[636.266357421875,1578.6932373046875],"size":[420.30511474609375,261.5306701660156],"flags":{},"order":58,"mode":0,"inputs":[{"localized_name":"t5","name":"t5","type":"WANTEXTENCODER","link":61},{"localized_name":"model_to_offload","name":"model_to_offload","shape":7,"type":"WANVIDEOMODEL","link":null},{"localized_name":"positive_prompt","name":"positive_prompt","type":"STRING","widget":{"name":"positive_prompt"},"link":null},{"localized_name":"negative_prompt","name":"negative_prompt","type":"STRING","widget":{"name":"negative_prompt"},"link":null},{"localized_name":"force_offload","name":"force_offload","shape":7,"type":"BOOLEAN","widget":{"name":"force_offload"},"link":null}],"outputs":[{"localized_name":"text_embeds","name":"text_embeds","type":"WANVIDEOTEXTEMBEDS","slot_index":0,"links":[72]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoTextEncode"},"widgets_values":["high quality nature video featuring a red panda balancing on a bamboo stem while a bird lands on it's head, on the background there is a waterfall","色调艳丽，过曝，静态，细节模糊不清，字幕，风格，作品，画作，画面，静止，整体发灰，最差质量，低质量，JPEG压缩残留，丑陋的，残缺的，多余的手指，画得不好的手部，画得不好的脸部，畸形的，毁容的，形态畸形的肢体，手指融合，静止不动的画面，杂乱的背景，三条腿，背景人很多，倒着走",true],"color":"#332922","bgcolor":"#593930"},{"id":68,"type":"LoadWanVideoT5TextEncoder","pos":[184.53428649902344,1580.2437744140625],"size":[377.1661376953125,130],"flags":{},"order":25,"mode":0,"inputs":[{"localized_name":"model_name","name":"model_name","type":"COMBO","widget":{"name":"model_name"},"link":null},{"localized_name":"precision","name":"precision","type":"COMBO","widget":{"name":"precision"},"link":null},{"localized_name":"load_device","name":"load_device","shape":7,"type":"COMBO","widget":{"name":"load_device"},"link":null},{"localized_name":"quantization","name":"quantization","shape":7,"type":"COMBO","widget":{"name":"quantization"},"link":null}],"outputs":[{"localized_name":"wan_t5_model","name":"wan_t5_model","type":"WANTEXTENCODER","slot_index":0,"links":[61,73]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"LoadWanVideoT5TextEncoder"},"widgets_values":["umt5-xxl-enc-bf16.safetensors","bf16","offload_device","disabled"],"color":"#332922","bgcolor":"#593930"},{"id":76,"type":"WanVideoTextEncodeSingle","pos":[623.1375732421875,2045.1153564453125],"size":[400,200],"flags":{},"order":59,"mode":0,"inputs":[{"localized_name":"t5","name":"t5","type":"WANTEXTENCODER","link":73},{"localized_name":"model_to_offload","name":"model_to_offload","shape":7,"type":"WANVIDEOMODEL","link":null},{"localized_name":"prompt","name":"prompt","type":"STRING","widget":{"name":"prompt"},"link":null},{"localized_name":"force_offload","name":"force_offload","shape":7,"type":"BOOLEAN","widget":{"name":"force_offload"},"link":null}],"outputs":[{"localized_name":"text_embeds","name":"text_embeds","type":"WANVIDEOTEXTEMBEDS","links":[74]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoTextEncodeSingle"},"widgets_values":["red bird",true]},{"id":77,"type":"WanVideoEmptyEmbeds","pos":[1273.69970703125,2944.6689453125],"size":[315,106],"flags":{},"order":26,"mode":0,"inputs":[{"localized_name":"control_embeds","name":"control_embeds","shape":7,"type":"WANVIDIMAGE_EMBEDS","link":null},{"localized_name":"width","name":"width","type":"INT","widget":{"name":"width"},"link":null},{"localized_name":"height","name":"height","type":"INT","widget":{"name":"height"},"link":null},{"localized_name":"num_frames","name":"num_frames","type":"INT","widget":{"name":"num_frames"},"link":null}],"outputs":[{"localized_name":"image_embeds","name":"image_embeds","type":"WANVIDIMAGE_EMBEDS","links":[76]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoEmptyEmbeds"},"widgets_values":[832,480,81]},{"id":78,"type":"Note","pos":[692.1643676757812,2919.14404296875],"size":[374.3061828613281,171.9547576904297],"flags":{},"order":27,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["fp8_fast seems to cause huge quality degradation\n\nfp_16_fast enables \"Full FP16 Accmumulation in FP16 GEMMs\" feature available in the very latest pytorch nightly, this is around 20% speed boost. \n\nSageattn if you have it installed can be used for almost double inference speed"],"color":"#432","bgcolor":"#653"},{"id":79,"type":"Note","pos":[-197.01402282714844,3171.525146484375],"size":[314.96246337890625,152.77333068847656],"flags":{},"order":28,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Adjust the blocks to swap based on your VRAM, this is a tradeoff between speed and memory usage.\n\nAlternatively there's option to use VRAM management introduced in DiffSynt-Studios. This is usually slower, but saves even more VRAM compared to BlockSwap"],"color":"#432","bgcolor":"#653"},{"id":80,"type":"WanVideoVRAMManagement","pos":[-189.76524353027344,3379.478759765625],"size":[315,58],"flags":{},"order":29,"mode":0,"inputs":[{"localized_name":"offload_percent","name":"offload_percent","type":"FLOAT","widget":{"name":"offload_percent"},"link":null}],"outputs":[{"localized_name":"vram_management_args","name":"vram_management_args","type":"VRAM_MANAGEMENTARGS","links":[]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoVRAMManagement"},"widgets_values":[1]},{"id":81,"type":"Note","pos":[-185.30442810058594,3500.32861328125],"size":[359.0753479003906,88],"flags":{},"order":30,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Models:\nhttps://huggingface.co/Kijai/WanVideo_comfy/tree/main"],"color":"#432","bgcolor":"#653"},{"id":82,"type":"Note","pos":[847.48974609375,2584.574462890625],"size":[327.61932373046875,88],"flags":{},"order":31,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Enhance-a-video can increase the fidelity of the results, too high values lead to noisy results."],"color":"#432","bgcolor":"#653"},{"id":83,"type":"Note","pos":[-130.1513671875,2841.1123046875],"size":[303.0501403808594,88],"flags":{},"order":32,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["If you have Triton installed, connect this for ~30% speed increase"],"color":"#432","bgcolor":"#653"},{"id":84,"type":"WanVideoEnhanceAVideo","pos":[851.607177734375,2727.142333984375],"size":[315,106],"flags":{},"order":33,"mode":0,"inputs":[{"localized_name":"weight","name":"weight","type":"FLOAT","widget":{"name":"weight"},"link":null},{"localized_name":"start_percent","name":"start_percent","type":"FLOAT","widget":{"name":"start_percent"},"link":null},{"localized_name":"end_percent","name":"end_percent","type":"FLOAT","widget":{"name":"end_percent"},"link":null}],"outputs":[{"localized_name":"feta_args","name":"feta_args","type":"FETAARGS","links":[78]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoEnhanceAVideo"},"widgets_values":[2,0,1]},{"id":85,"type":"WanVideoVAELoader","pos":[1655.8419189453125,2934.17822265625],"size":[315,82],"flags":{},"order":34,"mode":0,"inputs":[{"localized_name":"model_name","name":"model_name","type":"COMBO","widget":{"name":"model_name"},"link":null},{"localized_name":"precision","name":"precision","shape":7,"type":"COMBO","widget":{"name":"precision"},"link":null}],"outputs":[{"localized_name":"vae","name":"vae","type":"WANVAE","slot_index":0,"links":[79]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoVAELoader"},"widgets_values":["Wan2_1_VAE_bf16.safetensors","bf16"],"color":"#322","bgcolor":"#533"},{"id":86,"type":"WanVideoTorchCompileSettings","pos":[191.01397705078125,2838.829345703125],"size":[390.5999755859375,202],"flags":{},"order":35,"mode":0,"inputs":[{"localized_name":"backend","name":"backend","type":"COMBO","widget":{"name":"backend"},"link":null},{"localized_name":"fullgraph","name":"fullgraph","type":"BOOLEAN","widget":{"name":"fullgraph"},"link":null},{"localized_name":"mode","name":"mode","type":"COMBO","widget":{"name":"mode"},"link":null},{"localized_name":"dynamic","name":"dynamic","type":"BOOLEAN","widget":{"name":"dynamic"},"link":null},{"localized_name":"dynamo_cache_size_limit","name":"dynamo_cache_size_limit","type":"INT","widget":{"name":"dynamo_cache_size_limit"},"link":null},{"localized_name":"compile_transformer_blocks_only","name":"compile_transformer_blocks_only","type":"BOOLEAN","widget":{"name":"compile_transformer_blocks_only"},"link":null},{"localized_name":"dynamo_recompile_limit","name":"dynamo_recompile_limit","shape":7,"type":"INT","widget":{"name":"dynamo_recompile_limit"},"link":null}],"outputs":[{"localized_name":"torch_compile_args","name":"torch_compile_args","type":"WANCOMPILEARGS","slot_index":0,"links":[81]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoTorchCompileSettings"},"widgets_values":["inductor",false,"default",false,64,true,128]},{"id":87,"type":"WanVideoBlockSwap","pos":[221.59616088867188,3173.072509765625],"size":[315,154],"flags":{},"order":36,"mode":0,"inputs":[{"localized_name":"blocks_to_swap","name":"blocks_to_swap","type":"INT","widget":{"name":"blocks_to_swap"},"link":null},{"localized_name":"offload_img_emb","name":"offload_img_emb","type":"BOOLEAN","widget":{"name":"offload_img_emb"},"link":null},{"localized_name":"offload_txt_emb","name":"offload_txt_emb","type":"BOOLEAN","widget":{"name":"offload_txt_emb"},"link":null},{"localized_name":"use_non_blocking","name":"use_non_blocking","shape":7,"type":"BOOLEAN","widget":{"name":"use_non_blocking"},"link":null},{"localized_name":"vace_blocks_to_swap","name":"vace_blocks_to_swap","shape":7,"type":"INT","widget":{"name":"vace_blocks_to_swap"},"link":null}],"outputs":[{"localized_name":"block_swap_args","name":"block_swap_args","type":"BLOCKSWAPARGS","slot_index":0,"links":[82]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoBlockSwap"},"widgets_values":[15,false,false,true,0],"color":"#223","bgcolor":"#335"},{"id":88,"type":"WanVideoLoraSelect","pos":[-138.5966033935547,3003.596435546875],"size":[270,126],"flags":{},"order":37,"mode":0,"inputs":[{"localized_name":"prev_lora","name":"prev_lora","shape":7,"type":"WANVIDLORA","link":null},{"localized_name":"blocks","name":"blocks","shape":7,"type":"SELECTEDBLOCKS","link":null},{"localized_name":"lora","name":"lora","type":"COMBO","widget":{"name":"lora"},"link":null},{"localized_name":"strength","name":"strength","type":"FLOAT","widget":{"name":"strength"},"link":null},{"localized_name":"low_mem_load","name":"low_mem_load","shape":7,"type":"BOOLEAN","widget":{"name":"low_mem_load"},"link":null}],"outputs":[{"localized_name":"lora","name":"lora","type":"WANVIDLORA","links":[83]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoLoraSelect"},"widgets_values":["Wan21_T2V_14B_lightx2v_cfg_step_distill_lora_rank32.safetensors",1,false]},{"id":89,"type":"WanVideoSampler","pos":[1283.6727294921875,3114.97314453125],"size":[315,578],"flags":{},"order":72,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"WANVIDEOMODEL","link":75},{"localized_name":"image_embeds","name":"image_embeds","type":"WANVIDIMAGE_EMBEDS","link":76},{"localized_name":"text_embeds","name":"text_embeds","shape":7,"type":"WANVIDEOTEXTEMBEDS","link":90},{"localized_name":"samples","name":"samples","shape":7,"type":"LATENT","link":null},{"localized_name":"feta_args","name":"feta_args","shape":7,"type":"FETAARGS","link":78},{"localized_name":"context_options","name":"context_options","shape":7,"type":"WANVIDCONTEXT","link":null},{"localized_name":"cache_args","name":"cache_args","shape":7,"type":"CACHEARGS","link":null},{"localized_name":"flowedit_args","name":"flowedit_args","shape":7,"type":"FLOWEDITARGS","link":null},{"localized_name":"slg_args","name":"slg_args","shape":7,"type":"SLGARGS","link":null},{"localized_name":"loop_args","name":"loop_args","shape":7,"type":"LOOPARGS","link":null},{"localized_name":"experimental_args","name":"experimental_args","shape":7,"type":"EXPERIMENTALARGS","link":null},{"localized_name":"sigmas","name":"sigmas","shape":7,"type":"SIGMAS","link":null},{"localized_name":"unianimate_poses","name":"unianimate_poses","shape":7,"type":"UNIANIMATE_POSE","link":null},{"localized_name":"fantasytalking_embeds","name":"fantasytalking_embeds","shape":7,"type":"FANTASYTALKING_EMBEDS","link":null},{"localized_name":"uni3c_embeds","name":"uni3c_embeds","shape":7,"type":"UNI3C_EMBEDS","link":null},{"localized_name":"steps","name":"steps","type":"INT","widget":{"name":"steps"},"link":null},{"localized_name":"cfg","name":"cfg","type":"FLOAT","widget":{"name":"cfg"},"link":null},{"localized_name":"shift","name":"shift","type":"FLOAT","widget":{"name":"shift"},"link":null},{"localized_name":"seed","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"force_offload","name":"force_offload","type":"BOOLEAN","widget":{"name":"force_offload"},"link":null},{"localized_name":"scheduler","name":"scheduler","type":"COMBO","widget":{"name":"scheduler"},"link":null},{"localized_name":"riflex_freq_index","name":"riflex_freq_index","type":"INT","widget":{"name":"riflex_freq_index"},"link":null},{"localized_name":"denoise_strength","name":"denoise_strength","shape":7,"type":"FLOAT","widget":{"name":"denoise_strength"},"link":null},{"localized_name":"batched_cfg","name":"batched_cfg","shape":7,"type":"BOOLEAN","widget":{"name":"batched_cfg"},"link":null},{"localized_name":"rope_function","name":"rope_function","shape":7,"type":"COMBO","widget":{"name":"rope_function"},"link":null}],"outputs":[{"localized_name":"samples","name":"samples","type":"LATENT","slot_index":0,"links":[80]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoSampler"},"widgets_values":[4,1.0000000000000002,5,1057359483639287,"fixed",true,"unipc",0,1,false,"comfy"]},{"id":90,"type":"WanVideoDecode","pos":[1661.4063720703125,3111.591796875],"size":[315,174],"flags":{},"order":76,"mode":0,"inputs":[{"localized_name":"vae","name":"vae","type":"WANVAE","link":79},{"localized_name":"samples","name":"samples","type":"LATENT","link":80},{"localized_name":"enable_vae_tiling","name":"enable_vae_tiling","type":"BOOLEAN","widget":{"name":"enable_vae_tiling"},"link":null},{"localized_name":"tile_x","name":"tile_x","type":"INT","widget":{"name":"tile_x"},"link":null},{"localized_name":"tile_y","name":"tile_y","type":"INT","widget":{"name":"tile_y"},"link":null},{"localized_name":"tile_stride_x","name":"tile_stride_x","type":"INT","widget":{"name":"tile_stride_x"},"link":null},{"localized_name":"tile_stride_y","name":"tile_stride_y","type":"INT","widget":{"name":"tile_stride_y"},"link":null}],"outputs":[{"localized_name":"images","name":"images","type":"IMAGE","slot_index":0,"links":[88]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoDecode"},"widgets_values":[false,272,272,144,128],"color":"#322","bgcolor":"#533"},{"id":91,"type":"WanVideoModelLoader","pos":[588.8275756835938,3158.610595703125],"size":[477.4410095214844,254],"flags":{},"order":60,"mode":0,"inputs":[{"localized_name":"compile_args","name":"compile_args","shape":7,"type":"WANCOMPILEARGS","link":81},{"localized_name":"block_swap_args","name":"block_swap_args","shape":7,"type":"BLOCKSWAPARGS","link":82},{"localized_name":"lora","name":"lora","shape":7,"type":"WANVIDLORA","link":83},{"localized_name":"vram_management_args","name":"vram_management_args","shape":7,"type":"VRAM_MANAGEMENTARGS","link":null},{"localized_name":"vace_model","name":"vace_model","shape":7,"type":"VACEPATH","link":null},{"localized_name":"fantasytalking_model","name":"fantasytalking_model","shape":7,"type":"FANTASYTALKINGMODEL","link":null},{"localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"localized_name":"base_precision","name":"base_precision","type":"COMBO","widget":{"name":"base_precision"},"link":null},{"localized_name":"quantization","name":"quantization","type":"COMBO","widget":{"name":"quantization"},"link":null},{"localized_name":"load_device","name":"load_device","type":"COMBO","widget":{"name":"load_device"},"link":null},{"localized_name":"attention_mode","name":"attention_mode","shape":7,"type":"COMBO","widget":{"name":"attention_mode"},"link":null}],"outputs":[{"localized_name":"model","name":"model","type":"WANVIDEOMODEL","slot_index":0,"links":[75]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoModelLoader"},"widgets_values":["Wan2_1-T2V-14B_fp8_e4m3fn.safetensors","fp16_fast","fp8_e4m3fn","offload_device","sageattn"],"color":"#223","bgcolor":"#335"},{"id":94,"type":"LoadWanVideoT5TextEncoder","pos":[192.58551025390625,3481.9716796875],"size":[377.1661376953125,130],"flags":{},"order":38,"mode":0,"inputs":[{"localized_name":"model_name","name":"model_name","type":"COMBO","widget":{"name":"model_name"},"link":null},{"localized_name":"precision","name":"precision","type":"COMBO","widget":{"name":"precision"},"link":null},{"localized_name":"load_device","name":"load_device","shape":7,"type":"COMBO","widget":{"name":"load_device"},"link":null},{"localized_name":"quantization","name":"quantization","shape":7,"type":"COMBO","widget":{"name":"quantization"},"link":null}],"outputs":[{"localized_name":"wan_t5_model","name":"wan_t5_model","type":"WANTEXTENCODER","slot_index":0,"links":[86,87]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"LoadWanVideoT5TextEncoder"},"widgets_values":["umt5-xxl-enc-bf16.safetensors","bf16","offload_device","disabled"],"color":"#332922","bgcolor":"#593930"},{"id":95,"type":"WanVideoTextEncodeSingle","pos":[631.1889038085938,3946.84326171875],"size":[400,200],"flags":{},"order":62,"mode":0,"inputs":[{"localized_name":"t5","name":"t5","type":"WANTEXTENCODER","link":87},{"localized_name":"model_to_offload","name":"model_to_offload","shape":7,"type":"WANVIDEOMODEL","link":null},{"localized_name":"prompt","name":"prompt","type":"STRING","widget":{"name":"prompt"},"link":null},{"localized_name":"force_offload","name":"force_offload","shape":7,"type":"BOOLEAN","widget":{"name":"force_offload"},"link":null}],"outputs":[{"localized_name":"text_embeds","name":"text_embeds","type":"WANVIDEOTEXTEMBEDS","links":[85]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoTextEncodeSingle"},"widgets_values":["",true]},{"id":92,"type":"WanVideoApplyNAG","pos":[1077.7296142578125,3922.251953125],"size":[287.77734375,126],"flags":{},"order":68,"mode":0,"inputs":[{"localized_name":"original_text_embeds","name":"original_text_embeds","type":"WANVIDEOTEXTEMBEDS","link":84},{"localized_name":"nag_text_embeds","name":"nag_text_embeds","type":"WANVIDEOTEXTEMBEDS","link":85},{"localized_name":"nag_scale","name":"nag_scale","type":"FLOAT","widget":{"name":"nag_scale"},"link":null},{"localized_name":"nag_tau","name":"nag_tau","type":"FLOAT","widget":{"name":"nag_tau"},"link":null},{"localized_name":"nag_alpha","name":"nag_alpha","type":"FLOAT","widget":{"name":"nag_alpha"},"link":null}],"outputs":[{"localized_name":"text_embeds","name":"text_embeds","type":"WANVIDEOTEXTEMBEDS","links":[90]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoApplyNAG"},"widgets_values":[11,2.5,0.25]},{"id":93,"type":"WanVideoTextEncode","pos":[644.3176879882812,3480.421142578125],"size":[420.30511474609375,261.5306701660156],"flags":{},"order":61,"mode":0,"inputs":[{"localized_name":"t5","name":"t5","type":"WANTEXTENCODER","link":86},{"localized_name":"model_to_offload","name":"model_to_offload","shape":7,"type":"WANVIDEOMODEL","link":null},{"localized_name":"positive_prompt","name":"positive_prompt","type":"STRING","widget":{"name":"positive_prompt"},"link":null},{"localized_name":"negative_prompt","name":"negative_prompt","type":"STRING","widget":{"name":"negative_prompt"},"link":null},{"localized_name":"force_offload","name":"force_offload","shape":7,"type":"BOOLEAN","widget":{"name":"force_offload"},"link":null}],"outputs":[{"localized_name":"text_embeds","name":"text_embeds","type":"WANVIDEOTEXTEMBEDS","slot_index":0,"links":[84]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoTextEncode"},"widgets_values":["high quality nature video featuring a red panda balancing on a bamboo stem while a bird lands on it's head, on the background there is a waterfall","色调艳丽，过曝，静态，细节模糊不清，字幕，风格，作品，画作，画面，静止，整体发灰，最差质量，低质量，JPEG压缩残留，丑陋的，残缺的，多余的手指，画得不好的手部，画得不好的脸部，畸形的，毁容的，形态畸形的肢体，手指融合，静止不动的画面，杂乱的背景，三条腿，背景人很多，倒着走, red bird",true],"color":"#332922","bgcolor":"#593930"},{"id":96,"type":"VHS_VideoCombine","pos":[2076.0859375,2938.938720703125],"size":[1245.8460693359375,1055.2188720703125],"flags":{},"order":79,"mode":4,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":88},{"localized_name":"audio","name":"audio","shape":7,"type":"AUDIO","link":null},{"localized_name":"meta_batch","name":"meta_batch","shape":7,"type":"VHS_BatchManager","link":null},{"localized_name":"vae","name":"vae","shape":7,"type":"VAE","link":null},{"localized_name":"frame_rate","name":"frame_rate","type":"FLOAT","widget":{"name":"frame_rate"},"link":null},{"localized_name":"loop_count","name":"loop_count","type":"INT","widget":{"name":"loop_count"},"link":null},{"localized_name":"filename_prefix","name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":null},{"localized_name":"format","name":"format","type":"COMBO","widget":{"name":"format"},"link":null},{"localized_name":"pingpong","name":"pingpong","type":"BOOLEAN","widget":{"name":"pingpong"},"link":null},{"localized_name":"save_output","name":"save_output","type":"BOOLEAN","widget":{"name":"save_output"},"link":null}],"outputs":[{"localized_name":"Filenames","name":"Filenames","type":"VHS_FILENAMES","links":null}],"properties":{"cnr_id":"comfyui-videohelpersuite","ver":"1.6.1","Node name for S&R":"VHS_VideoCombine"},"widgets_values":{"frame_rate":16,"loop_count":0,"filename_prefix":"selfforcing-ref-negative","format":"video/h264-mp4","pix_fmt":"yuv420p","crf":19,"save_metadata":true,"trim_to_audio":false,"pingpong":false,"save_output":true,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"selfforcing-ref-negative_00004.mp4","subfolder":"","type":"output","format":"video/h264-mp4","frame_rate":16,"workflow":"selfforcing-ref-negative_00004.png","fullpath":"/data/ComfyUI2505/output/selfforcing-ref-negative_00004.mp4"}}}},{"id":98,"type":"WanVideoEmptyEmbeds","pos":[1364.798583984375,4706.9833984375],"size":[315,106],"flags":{},"order":39,"mode":0,"inputs":[{"localized_name":"control_embeds","name":"control_embeds","shape":7,"type":"WANVIDIMAGE_EMBEDS","link":null},{"localized_name":"width","name":"width","type":"INT","widget":{"name":"width"},"link":null},{"localized_name":"height","name":"height","type":"INT","widget":{"name":"height"},"link":null},{"localized_name":"num_frames","name":"num_frames","type":"INT","widget":{"name":"num_frames"},"link":null}],"outputs":[{"localized_name":"image_embeds","name":"image_embeds","type":"WANVIDIMAGE_EMBEDS","links":[93]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoEmptyEmbeds"},"widgets_values":[832,480,81]},{"id":99,"type":"Note","pos":[783.2637939453125,4681.45849609375],"size":[374.3061828613281,171.9547576904297],"flags":{},"order":40,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["fp8_fast seems to cause huge quality degradation\n\nfp_16_fast enables \"Full FP16 Accmumulation in FP16 GEMMs\" feature available in the very latest pytorch nightly, this is around 20% speed boost. \n\nSageattn if you have it installed can be used for almost double inference speed"],"color":"#432","bgcolor":"#653"},{"id":100,"type":"Note","pos":[-105.91400146484375,4933.83935546875],"size":[314.96246337890625,152.77333068847656],"flags":{},"order":41,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Adjust the blocks to swap based on your VRAM, this is a tradeoff between speed and memory usage.\n\nAlternatively there's option to use VRAM management introduced in DiffSynt-Studios. This is usually slower, but saves even more VRAM compared to BlockSwap"],"color":"#432","bgcolor":"#653"},{"id":101,"type":"WanVideoVRAMManagement","pos":[-98.66522216796875,5141.79296875],"size":[315,58],"flags":{},"order":42,"mode":0,"inputs":[{"localized_name":"offload_percent","name":"offload_percent","type":"FLOAT","widget":{"name":"offload_percent"},"link":null}],"outputs":[{"localized_name":"vram_management_args","name":"vram_management_args","type":"VRAM_MANAGEMENTARGS","links":[]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoVRAMManagement"},"widgets_values":[1]},{"id":102,"type":"Note","pos":[-94.20440673828125,5262.64306640625],"size":[359.0753479003906,88],"flags":{},"order":43,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Models:\nhttps://huggingface.co/Kijai/WanVideo_comfy/tree/main"],"color":"#432","bgcolor":"#653"},{"id":103,"type":"Note","pos":[-39.0514030456543,4603.4267578125],"size":[303.0501403808594,88],"flags":{},"order":44,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["If you have Triton installed, connect this for ~30% speed increase"],"color":"#432","bgcolor":"#653"},{"id":104,"type":"WanVideoEnhanceAVideo","pos":[942.7064819335938,4489.45654296875],"size":[315,106],"flags":{},"order":45,"mode":0,"inputs":[{"localized_name":"weight","name":"weight","type":"FLOAT","widget":{"name":"weight"},"link":null},{"localized_name":"start_percent","name":"start_percent","type":"FLOAT","widget":{"name":"start_percent"},"link":null},{"localized_name":"end_percent","name":"end_percent","type":"FLOAT","widget":{"name":"end_percent"},"link":null}],"outputs":[{"localized_name":"feta_args","name":"feta_args","type":"FETAARGS","links":[95]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoEnhanceAVideo"},"widgets_values":[2,0,1]},{"id":105,"type":"WanVideoVAELoader","pos":[1746.9407958984375,4696.49267578125],"size":[315,82],"flags":{},"order":46,"mode":0,"inputs":[{"localized_name":"model_name","name":"model_name","type":"COMBO","widget":{"name":"model_name"},"link":null},{"localized_name":"precision","name":"precision","shape":7,"type":"COMBO","widget":{"name":"precision"},"link":null}],"outputs":[{"localized_name":"vae","name":"vae","type":"WANVAE","slot_index":0,"links":[96]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoVAELoader"},"widgets_values":["Wan2_1_VAE_bf16.safetensors","bf16"],"color":"#322","bgcolor":"#533"},{"id":106,"type":"WanVideoTorchCompileSettings","pos":[282.11395263671875,4601.1435546875],"size":[390.5999755859375,202],"flags":{},"order":47,"mode":0,"inputs":[{"localized_name":"backend","name":"backend","type":"COMBO","widget":{"name":"backend"},"link":null},{"localized_name":"fullgraph","name":"fullgraph","type":"BOOLEAN","widget":{"name":"fullgraph"},"link":null},{"localized_name":"mode","name":"mode","type":"COMBO","widget":{"name":"mode"},"link":null},{"localized_name":"dynamic","name":"dynamic","type":"BOOLEAN","widget":{"name":"dynamic"},"link":null},{"localized_name":"dynamo_cache_size_limit","name":"dynamo_cache_size_limit","type":"INT","widget":{"name":"dynamo_cache_size_limit"},"link":null},{"localized_name":"compile_transformer_blocks_only","name":"compile_transformer_blocks_only","type":"BOOLEAN","widget":{"name":"compile_transformer_blocks_only"},"link":null},{"localized_name":"dynamo_recompile_limit","name":"dynamo_recompile_limit","shape":7,"type":"INT","widget":{"name":"dynamo_recompile_limit"},"link":null}],"outputs":[{"localized_name":"torch_compile_args","name":"torch_compile_args","type":"WANCOMPILEARGS","slot_index":0,"links":[98]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoTorchCompileSettings"},"widgets_values":["inductor",false,"default",false,64,true,128]},{"id":107,"type":"WanVideoBlockSwap","pos":[312.6961669921875,4935.38671875],"size":[315,154],"flags":{},"order":48,"mode":0,"inputs":[{"localized_name":"blocks_to_swap","name":"blocks_to_swap","type":"INT","widget":{"name":"blocks_to_swap"},"link":null},{"localized_name":"offload_img_emb","name":"offload_img_emb","type":"BOOLEAN","widget":{"name":"offload_img_emb"},"link":null},{"localized_name":"offload_txt_emb","name":"offload_txt_emb","type":"BOOLEAN","widget":{"name":"offload_txt_emb"},"link":null},{"localized_name":"use_non_blocking","name":"use_non_blocking","shape":7,"type":"BOOLEAN","widget":{"name":"use_non_blocking"},"link":null},{"localized_name":"vace_blocks_to_swap","name":"vace_blocks_to_swap","shape":7,"type":"INT","widget":{"name":"vace_blocks_to_swap"},"link":null}],"outputs":[{"localized_name":"block_swap_args","name":"block_swap_args","type":"BLOCKSWAPARGS","slot_index":0,"links":[99]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoBlockSwap"},"widgets_values":[15,false,false,true,0],"color":"#223","bgcolor":"#335"},{"id":108,"type":"WanVideoLoraSelect","pos":[-47.496620178222656,4765.91064453125],"size":[270,126],"flags":{},"order":49,"mode":0,"inputs":[{"localized_name":"prev_lora","name":"prev_lora","shape":7,"type":"WANVIDLORA","link":null},{"localized_name":"blocks","name":"blocks","shape":7,"type":"SELECTEDBLOCKS","link":null},{"localized_name":"lora","name":"lora","type":"COMBO","widget":{"name":"lora"},"link":null},{"localized_name":"strength","name":"strength","type":"FLOAT","widget":{"name":"strength"},"link":null},{"localized_name":"low_mem_load","name":"low_mem_load","shape":7,"type":"BOOLEAN","widget":{"name":"low_mem_load"},"link":null}],"outputs":[{"localized_name":"lora","name":"lora","type":"WANVIDLORA","links":[100]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoLoraSelect"},"widgets_values":["Wan21_T2V_14B_lightx2v_cfg_step_distill_lora_rank32.safetensors",1,false]},{"id":110,"type":"WanVideoDecode","pos":[1752.5052490234375,4873.90625],"size":[315,174],"flags":{},"order":77,"mode":0,"inputs":[{"localized_name":"vae","name":"vae","type":"WANVAE","link":96},{"localized_name":"samples","name":"samples","type":"LATENT","link":97},{"localized_name":"enable_vae_tiling","name":"enable_vae_tiling","type":"BOOLEAN","widget":{"name":"enable_vae_tiling"},"link":null},{"localized_name":"tile_x","name":"tile_x","type":"INT","widget":{"name":"tile_x"},"link":null},{"localized_name":"tile_y","name":"tile_y","type":"INT","widget":{"name":"tile_y"},"link":null},{"localized_name":"tile_stride_x","name":"tile_stride_x","type":"INT","widget":{"name":"tile_stride_x"},"link":null},{"localized_name":"tile_stride_y","name":"tile_stride_y","type":"INT","widget":{"name":"tile_stride_y"},"link":null}],"outputs":[{"localized_name":"images","name":"images","type":"IMAGE","slot_index":0,"links":[91]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoDecode"},"widgets_values":[false,272,272,144,128],"color":"#322","bgcolor":"#533"},{"id":111,"type":"WanVideoModelLoader","pos":[679.9270629882812,4920.9248046875],"size":[477.4410095214844,254],"flags":{},"order":63,"mode":0,"inputs":[{"localized_name":"compile_args","name":"compile_args","shape":7,"type":"WANCOMPILEARGS","link":98},{"localized_name":"block_swap_args","name":"block_swap_args","shape":7,"type":"BLOCKSWAPARGS","link":99},{"localized_name":"lora","name":"lora","shape":7,"type":"WANVIDLORA","link":100},{"localized_name":"vram_management_args","name":"vram_management_args","shape":7,"type":"VRAM_MANAGEMENTARGS","link":null},{"localized_name":"vace_model","name":"vace_model","shape":7,"type":"VACEPATH","link":null},{"localized_name":"fantasytalking_model","name":"fantasytalking_model","shape":7,"type":"FANTASYTALKINGMODEL","link":null},{"localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"localized_name":"base_precision","name":"base_precision","type":"COMBO","widget":{"name":"base_precision"},"link":null},{"localized_name":"quantization","name":"quantization","type":"COMBO","widget":{"name":"quantization"},"link":null},{"localized_name":"load_device","name":"load_device","type":"COMBO","widget":{"name":"load_device"},"link":null},{"localized_name":"attention_mode","name":"attention_mode","shape":7,"type":"COMBO","widget":{"name":"attention_mode"},"link":null}],"outputs":[{"localized_name":"model","name":"model","type":"WANVIDEOMODEL","slot_index":0,"links":[92]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoModelLoader"},"widgets_values":["Wan2_1-T2V-14B_fp8_e4m3fn.safetensors","fp16_fast","fp8_e4m3fn","offload_device","sageattn"],"color":"#223","bgcolor":"#335"},{"id":112,"type":"LoadWanVideoT5TextEncoder","pos":[283.68548583984375,5244.2861328125],"size":[377.1661376953125,130],"flags":{},"order":50,"mode":0,"inputs":[{"localized_name":"model_name","name":"model_name","type":"COMBO","widget":{"name":"model_name"},"link":null},{"localized_name":"precision","name":"precision","type":"COMBO","widget":{"name":"precision"},"link":null},{"localized_name":"load_device","name":"load_device","shape":7,"type":"COMBO","widget":{"name":"load_device"},"link":null},{"localized_name":"quantization","name":"quantization","shape":7,"type":"COMBO","widget":{"name":"quantization"},"link":null}],"outputs":[{"localized_name":"wan_t5_model","name":"wan_t5_model","type":"WANTEXTENCODER","slot_index":0,"links":[101,104]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"LoadWanVideoT5TextEncoder"},"widgets_values":["umt5-xxl-enc-bf16.safetensors","bf16","offload_device","disabled"],"color":"#332922","bgcolor":"#593930"},{"id":113,"type":"WanVideoTextEncodeSingle","pos":[722.288330078125,5709.15771484375],"size":[400,200],"flags":{},"order":64,"mode":0,"inputs":[{"localized_name":"t5","name":"t5","type":"WANTEXTENCODER","link":101},{"localized_name":"model_to_offload","name":"model_to_offload","shape":7,"type":"WANVIDEOMODEL","link":null},{"localized_name":"prompt","name":"prompt","type":"STRING","widget":{"name":"prompt"},"link":null},{"localized_name":"force_offload","name":"force_offload","shape":7,"type":"BOOLEAN","widget":{"name":"force_offload"},"link":null}],"outputs":[{"localized_name":"text_embeds","name":"text_embeds","type":"WANVIDEOTEXTEMBEDS","links":[103]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoTextEncodeSingle"},"widgets_values":["",true]},{"id":114,"type":"WanVideoApplyNAG","pos":[1168.8284912109375,5684.56640625],"size":[287.77734375,126],"flags":{},"order":69,"mode":0,"inputs":[{"localized_name":"original_text_embeds","name":"original_text_embeds","type":"WANVIDEOTEXTEMBEDS","link":102},{"localized_name":"nag_text_embeds","name":"nag_text_embeds","type":"WANVIDEOTEXTEMBEDS","link":103},{"localized_name":"nag_scale","name":"nag_scale","type":"FLOAT","widget":{"name":"nag_scale"},"link":null},{"localized_name":"nag_tau","name":"nag_tau","type":"FLOAT","widget":{"name":"nag_tau"},"link":null},{"localized_name":"nag_alpha","name":"nag_alpha","type":"FLOAT","widget":{"name":"nag_alpha"},"link":null}],"outputs":[{"localized_name":"text_embeds","name":"text_embeds","type":"WANVIDEOTEXTEMBEDS","links":[94]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoApplyNAG"},"widgets_values":[11,2.5,0.25]},{"id":115,"type":"WanVideoTextEncode","pos":[735.4171142578125,5242.7353515625],"size":[420.30511474609375,261.5306701660156],"flags":{},"order":65,"mode":0,"inputs":[{"localized_name":"t5","name":"t5","type":"WANTEXTENCODER","link":104},{"localized_name":"model_to_offload","name":"model_to_offload","shape":7,"type":"WANVIDEOMODEL","link":null},{"localized_name":"positive_prompt","name":"positive_prompt","type":"STRING","widget":{"name":"positive_prompt"},"link":null},{"localized_name":"negative_prompt","name":"negative_prompt","type":"STRING","widget":{"name":"negative_prompt"},"link":null},{"localized_name":"force_offload","name":"force_offload","shape":7,"type":"BOOLEAN","widget":{"name":"force_offload"},"link":null}],"outputs":[{"localized_name":"text_embeds","name":"text_embeds","type":"WANVIDEOTEXTEMBEDS","slot_index":0,"links":[102]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoTextEncode"},"widgets_values":["high quality nature video featuring a red panda balancing on a bamboo stem while a bird lands on it's head, on the background there is a waterfall","色调艳丽，过曝，静态，细节模糊不清，字幕，风格，作品，画作，画面，静止，整体发灰，最差质量，低质量，JPEG压缩残留，丑陋的，残缺的，多余的手指，画得不好的手部，画得不好的脸部，畸形的，毁容的，形态畸形的肢体，手指融合，静止不动的画面，杂乱的背景，三条腿，背景人很多，倒着走, red bird",true],"color":"#332922","bgcolor":"#593930"},{"id":109,"type":"WanVideoSampler","pos":[1374.7716064453125,4877.28759765625],"size":[315,578],"flags":{},"order":73,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"WANVIDEOMODEL","link":92},{"localized_name":"image_embeds","name":"image_embeds","type":"WANVIDIMAGE_EMBEDS","link":93},{"localized_name":"text_embeds","name":"text_embeds","shape":7,"type":"WANVIDEOTEXTEMBEDS","link":94},{"localized_name":"samples","name":"samples","shape":7,"type":"LATENT","link":null},{"localized_name":"feta_args","name":"feta_args","shape":7,"type":"FETAARGS","link":95},{"localized_name":"context_options","name":"context_options","shape":7,"type":"WANVIDCONTEXT","link":null},{"localized_name":"cache_args","name":"cache_args","shape":7,"type":"CACHEARGS","link":null},{"localized_name":"flowedit_args","name":"flowedit_args","shape":7,"type":"FLOWEDITARGS","link":null},{"localized_name":"slg_args","name":"slg_args","shape":7,"type":"SLGARGS","link":null},{"localized_name":"loop_args","name":"loop_args","shape":7,"type":"LOOPARGS","link":null},{"localized_name":"experimental_args","name":"experimental_args","shape":7,"type":"EXPERIMENTALARGS","link":null},{"localized_name":"sigmas","name":"sigmas","shape":7,"type":"SIGMAS","link":null},{"localized_name":"unianimate_poses","name":"unianimate_poses","shape":7,"type":"UNIANIMATE_POSE","link":null},{"localized_name":"fantasytalking_embeds","name":"fantasytalking_embeds","shape":7,"type":"FANTASYTALKING_EMBEDS","link":null},{"localized_name":"uni3c_embeds","name":"uni3c_embeds","shape":7,"type":"UNI3C_EMBEDS","link":null},{"localized_name":"steps","name":"steps","type":"INT","widget":{"name":"steps"},"link":null},{"localized_name":"cfg","name":"cfg","type":"FLOAT","widget":{"name":"cfg"},"link":null},{"localized_name":"shift","name":"shift","type":"FLOAT","widget":{"name":"shift"},"link":null},{"localized_name":"seed","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"force_offload","name":"force_offload","type":"BOOLEAN","widget":{"name":"force_offload"},"link":null},{"localized_name":"scheduler","name":"scheduler","type":"COMBO","widget":{"name":"scheduler"},"link":null},{"localized_name":"riflex_freq_index","name":"riflex_freq_index","type":"INT","widget":{"name":"riflex_freq_index"},"link":null},{"localized_name":"denoise_strength","name":"denoise_strength","shape":7,"type":"FLOAT","widget":{"name":"denoise_strength"},"link":null},{"localized_name":"batched_cfg","name":"batched_cfg","shape":7,"type":"BOOLEAN","widget":{"name":"batched_cfg"},"link":null},{"localized_name":"rope_function","name":"rope_function","shape":7,"type":"COMBO","widget":{"name":"rope_function"},"link":null}],"outputs":[{"localized_name":"samples","name":"samples","type":"LATENT","slot_index":0,"links":[97]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"8479624614ec0d52e982bbbab633736fb1a15eef","Node name for S&R":"WanVideoSampler"},"widgets_values":[4,7.000000000000002,5,1057359483639287,"fixed",true,"unipc",0,1,false,"comfy"]},{"id":97,"type":"VHS_VideoCombine","pos":[2167.1845703125,4701.2529296875],"size":[1245.8460693359375,1055.2188720703125],"flags":{},"order":80,"mode":4,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":91},{"localized_name":"audio","name":"audio","shape":7,"type":"AUDIO","link":null},{"localized_name":"meta_batch","name":"meta_batch","shape":7,"type":"VHS_BatchManager","link":null},{"localized_name":"vae","name":"vae","shape":7,"type":"VAE","link":null},{"localized_name":"frame_rate","name":"frame_rate","type":"FLOAT","widget":{"name":"frame_rate"},"link":null},{"localized_name":"loop_count","name":"loop_count","type":"INT","widget":{"name":"loop_count"},"link":null},{"localized_name":"filename_prefix","name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":null},{"localized_name":"format","name":"format","type":"COMBO","widget":{"name":"format"},"link":null},{"localized_name":"pingpong","name":"pingpong","type":"BOOLEAN","widget":{"name":"pingpong"},"link":null},{"localized_name":"save_output","name":"save_output","type":"BOOLEAN","widget":{"name":"save_output"},"link":null}],"outputs":[{"localized_name":"Filenames","name":"Filenames","type":"VHS_FILENAMES","links":null}],"properties":{"cnr_id":"comfyui-videohelpersuite","ver":"1.6.1","Node name for S&R":"VHS_VideoCombine"},"widgets_values":{"frame_rate":16,"loop_count":0,"filename_prefix":"selfforcing-ref-cfg","format":"video/h264-mp4","pix_fmt":"yuv420p","crf":19,"save_metadata":true,"trim_to_audio":false,"pingpong":false,"save_output":true,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"selfforcing-ref-cfg_00001.mp4","subfolder":"","type":"output","format":"video/h264-mp4","frame_rate":16,"workflow":"selfforcing-ref-cfg_00001.png","fullpath":"/data/ComfyUI2505/output/selfforcing-ref-cfg_00001.mp4"}}}},{"id":57,"type":"VHS_VideoCombine","pos":[2029.0322265625,1032.1839599609375],"size":[1245.8460693359375,1055.2188720703125],"flags":{},"order":78,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":60},{"localized_name":"audio","name":"audio","shape":7,"type":"AUDIO","link":null},{"localized_name":"meta_batch","name":"meta_batch","shape":7,"type":"VHS_BatchManager","link":null},{"localized_name":"vae","name":"vae","shape":7,"type":"VAE","link":null},{"localized_name":"frame_rate","name":"frame_rate","type":"FLOAT","widget":{"name":"frame_rate"},"link":null},{"localized_name":"loop_count","name":"loop_count","type":"INT","widget":{"name":"loop_count"},"link":null},{"localized_name":"filename_prefix","name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":null},{"localized_name":"format","name":"format","type":"COMBO","widget":{"name":"format"},"link":null},{"localized_name":"pingpong","name":"pingpong","type":"BOOLEAN","widget":{"name":"pingpong"},"link":null},{"localized_name":"save_output","name":"save_output","type":"BOOLEAN","widget":{"name":"save_output"},"link":null}],"outputs":[{"localized_name":"Filenames","name":"Filenames","type":"VHS_FILENAMES","links":null}],"properties":{"cnr_id":"comfyui-videohelpersuite","ver":"1.6.1","Node name for S&R":"VHS_VideoCombine"},"widgets_values":{"frame_rate":16,"loop_count":0,"filename_prefix":"selfforcing-nag","format":"video/h264-mp4","pix_fmt":"yuv420p","crf":19,"save_metadata":true,"trim_to_audio":false,"pingpong":false,"save_output":true,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"selfforcing-nag_00006.mp4","subfolder":"","type":"output","format":"video/h264-mp4","frame_rate":16,"workflow":"selfforcing-nag_00006.png","fullpath":"/data/ComfyUI2505/output/selfforcing-nag_00006.mp4"}}}},{"id":116,"type":"Note","pos":[3536.9130859375,-273.028564453125],"size":[415.3624572753906,153.05877685546875],"flags":{},"order":51,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Reference - Ground truth"],"color":"#432","bgcolor":"#653"},{"id":118,"type":"Note","pos":[3502.421142578125,1412.5792236328125],"size":[415.3624572753906,153.05877685546875],"flags":{},"order":52,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Use NAG as 'negative prompt' with distilled models"],"color":"#432","bgcolor":"#653"},{"id":119,"type":"Note","pos":[3540.415771484375,3076.916015625],"size":[415.3624572753906,153.05877685546875],"flags":{},"order":53,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Standard negative prompt does not work when CFG = 1"],"color":"#432","bgcolor":"#653"},{"id":120,"type":"Note","pos":[3621.278076171875,4930.318359375],"size":[415.3624572753906,153.05877685546875],"flags":{},"order":54,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["High CFG values do not work with distilled models"],"color":"#432","bgcolor":"#653"}],"links":[[15,11,0,16,0,"WANTEXTENCODER"],[29,22,0,27,0,"WANVIDEOMODEL"],[30,16,0,27,2,"WANVIDEOTEXTEMBEDS"],[33,27,0,28,1,"LATENT"],[36,28,0,30,0,"IMAGE"],[42,37,0,27,1,"WANVIDIMAGE_EMBEDS"],[43,38,0,28,0,"VAE"],[50,39,0,22,1,"BLOCKSWAPARGS"],[57,55,0,27,4,"FETAARGS"],[58,35,0,22,0,"WANCOMPILEARGS"],[59,56,0,22,2,"WANVIDLORA"],[60,73,0,57,0,"IMAGE"],[61,68,0,65,0,"WANTEXTENCODER"],[62,74,0,72,0,"WANVIDEOMODEL"],[63,58,0,72,1,"WANVIDIMAGE_EMBEDS"],[65,66,0,72,4,"FETAARGS"],[66,67,0,73,0,"WANVAE"],[67,72,0,73,1,"LATENT"],[68,69,0,74,0,"WANCOMPILEARGS"],[69,70,0,74,1,"BLOCKSWAPARGS"],[70,71,0,74,2,"WANVIDLORA"],[71,75,0,72,2,"WANVIDEOTEXTEMBEDS"],[72,65,0,75,0,"WANVIDEOTEXTEMBEDS"],[73,68,0,76,0,"WANTEXTENCODER"],[74,76,0,75,1,"WANVIDEOTEXTEMBEDS"],[75,91,0,89,0,"WANVIDEOMODEL"],[76,77,0,89,1,"WANVIDIMAGE_EMBEDS"],[78,84,0,89,4,"FETAARGS"],[79,85,0,90,0,"WANVAE"],[80,89,0,90,1,"LATENT"],[81,86,0,91,0,"WANCOMPILEARGS"],[82,87,0,91,1,"BLOCKSWAPARGS"],[83,88,0,91,2,"WANVIDLORA"],[84,93,0,92,0,"WANVIDEOTEXTEMBEDS"],[85,95,0,92,1,"WANVIDEOTEXTEMBEDS"],[86,94,0,93,0,"WANTEXTENCODER"],[87,94,0,95,0,"WANTEXTENCODER"],[88,90,0,96,0,"IMAGE"],[90,92,0,89,2,"WANVIDEOTEXTEMBEDS"],[91,110,0,97,0,"IMAGE"],[92,111,0,109,0,"WANVIDEOMODEL"],[93,98,0,109,1,"WANVIDIMAGE_EMBEDS"],[94,114,0,109,2,"WANVIDEOTEXTEMBEDS"],[95,104,0,109,4,"FETAARGS"],[96,105,0,110,0,"WANVAE"],[97,109,0,110,1,"LATENT"],[98,106,0,111,0,"WANCOMPILEARGS"],[99,107,0,111,1,"BLOCKSWAPARGS"],[100,108,0,111,2,"WANVIDLORA"],[101,112,0,113,0,"WANTEXTENCODER"],[102,115,0,114,0,"WANVIDEOTEXTEMBEDS"],[103,113,0,114,1,"WANVIDEOTEXTEMBEDS"],[104,112,0,115,0,"WANTEXTENCODER"]],"groups":[],"config":{},"extra":{"ds":{"scale":0.12100000000000115,"offset":[9018.272746904338,871.7491538188567]},"node_versions":{"ComfyUI-WanVideoWrapper":"5a2383621a05825d0d0437781afcb8552d9590fd","comfy-core":"0.3.26","ComfyUI-VideoHelperSuite":"0a75c7958fe320efcb052f1d9f8451fd20c730a8"},"VHS_latentpreview":true,"VHS_latentpreviewrate":0,"VHS_MetadataImage":true,"VHS_KeepIntermediate":true},"version":0.4}
